
#####################################################
#                                                   #
#   Python para Pentesters                          #
#   https://solyd.com.br/treinamentos               #
#                                                   #
#   Desenvolvedor: h1s0k4                           #
#   E-mail: willian_brito00@hotmail.com             #
#                                                   #
#   USAGE: python raw_sniffer.py                    #
#                                                   #
#####################################################

import socket
import struct

s = socket.socket(socket.AF_PACKET, socket.SOCK_RAW, socket.ntohs(3))

while True:
    pacote = s.recvfrom(65565)

    traduzido = struct.unpack("!BBHHHBBH4s4s", pacote[0][0:20])

    print "From:", pacote[1][0]
    print "Pacote:", traduzido
    print "IP Version:", traduzido[0] >> 4
    print "TTL:", traduzido[5]
    print "Protocol:", traduzido[6]
    print "Source IP:", socket.inet_ntoa(traduzido[8])
    print "Target IP:", socket.inet_ntoa(traduzido[9])
    print pacote[0]
