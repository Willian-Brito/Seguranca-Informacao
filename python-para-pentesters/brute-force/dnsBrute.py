#########################################################
# Desenvolvedor: h1s0k4                                 #
#                                                       #
# Usage: python3 dnsBrute.py bancocn.com subdomains.txt #
#                                                       #
#########################################################

import sys
import dns.resolver

def DnsBrute():
    try:
        dominio = sys.argv[1]
        nome_do_arquivo = sys.argv[2]
    except:
        print("Argumentos Invalidos")
        print("Usage: dnsBrute.py <DOMINIO> <WORDLIST>")
        sys.exit(1)

    try:
        arquivo = open(nome_do_arquivo)
        subdominios = arquivo.read().splitlines()

    except:
        print("Arquivo nao encontrado")
        sys.exit(1)

    for subdominio in subdominios:

        try:
            domesub = subdominio + '.' + dominio
            resultados = dns.resolver.query(domesub, 'a')
            for resultado in resultados:
                print(domesub, "->", resultado)
        except:
            pass

DnsBrute()